\chapter{Reconstruction}

How do we turn electrical signals into physics.

\section{Tracks}
\label{sec:tracks}

\section{Primary Vertex}
\label{sec:vertex}

\section{Particle Flow}
\label{sec:particle_flow}

\section{Photons}
\label{sec:photons}

We select high-\ET\ photons from the ECAL Barrel. First, we apply the following cuts to select high-\ET\ photon candidates:
\begin{itemize}
\item Super cluster $\ET > 175\GeV$
\item Super cluster $\abs\eta < 1.4442$ .
\end{itemize}
We use the uncorrected \ET\ of the supercluster as photon \ET. 
The use of supercluster raw \ET\ is motivated by an observation that this energy correction causes photon objects with large cluster shower width to exhibit unphysical energies. 
Figure~\ref{fig:corr_vs_sieie} is a profile of the magnitude of the energy correction in bins of \sieie. 
As an illustration, an unphysically large correction is causing the transverse momentum of the photon object in the event shown in Fig.~\ref{fig:badcorr_evtdisp} to be nearly twice as large as the \met, which is supposed to balance the visible, \ie, photon momentum. 
Photon objects with wide showers are used to estimate the hadron-to-photon misidentification background, while the photon energy resolution has an insignificant effect. 
Therefore, unbiased supercluster energy was chosen over the corrected photon energy.

\begin{figure}[htbp]
  \begin{center}
    \includegraphics[width=0.6\textwidth]{Reconstruction/Figures/corr_vs_sieie.pdf}
    \caption{
      Magnitude of the energy correction on the photon object in bins of \sieie.
    }
    \label{fig:corr_vs_sieie}
  \end{center}
\end{figure}

\begin{figure}[htbp]
  \begin{center}
    \includegraphics[width=0.6\textwidth]{Reconstruction/Figures/badcorr_evtdisp.pdf}
    \caption{
      An example event where a photon with a wide shower receives a large energy correction.
    }
    \label{fig:badcorr_evtdisp}
  \end{center}
\end{figure}

To reduce hadron-to-photon misidentification rate, we apply the following collection of isolation and shower shape cuts, which will hereby be referred to as the \egamma\ ID:
\begin{itemize}
  \item $H/E < 0.0260$
  \item $\sieie < 0.01040$
  \item $\rho$-corrected maximum PF charged hadron isolation $\ICHmax < 1.146\GeV$
  \item $\rho$-corrected PF neutral hadron isolation $\INH < 2.792\GeV + 0.0112 \times \ETg + 0.000028 \times \left(\ETg \right)^2/\GeV$
  \item $\rho$-corrected PF photon isolation $\Ig < 2.176\GeV + 0.0043 \times \ETg$
\end{itemize}

In the identification criteria, the maximum PF charged hadron isolation \ICHmax\ is the maximum of the standard PF charged hadron isolation computed for all reconstructed vertices. 
Standard PF charged hadron isolation is computed with respect to the primary vertex. 
Since the object with the highest \pt\ in the selected events is typically a photon, which has no intrinsic association to a vertex, it is possible that the identified primary vertex does not correspond to the \Pp\Pp\ interaction from which the photon object originate. 
In such cases, the photon object can be surrounded by charged hadrons, \ie, a part of a jet, and still appear isolated under the standard charged hadron isolation. 
The use of maximum isolation is a conservative measure to address such misidentification.

Effective areas for isolations are also recomputed to maintain flat pileup dependence as given in Table~\ref{tab:ea}
%
\begin{table}[htbp]
  \begin{center}
    \caption{Effective areas for isolations.} 
    \label{tab:ea}
    \begin{tabular}{|c|c|c|}
      \hline
      Isolation & $\abs\eta < 1.0$ & $1.0 < \abs\eta < 1.479$  \\
      \hline
      maximum PF charged hadron isolation & 0.01064& 0.1026 \\
      PF neutral hadron isolation & 0.0597 & 0.0807 \\
      PF photon isolation & 0.1210 & 0.1107 \\
      \hline
    \end{tabular}
  \end{center}
\end{table}

To reject electrons from the candidate sample, we require that no electron track seeds can be associated to the super cluster. This is known as the pixel seed veto.

To clean the candidate sample from photon objects originating from non-collision sources. we apply the following collection of cuts, which combined with the pixel seed veto constitutes the \Pgg-specific ID:
\begin{itemize} 
  \item Beam halo tagger $\emip < 4.9\GeV$
  \item $\sieie > 0.001$
  \item $\sipip > 0.001$
  \item Cluster seed time $\abs\tseed < 3\ns$ .
\end{itemize}
Beam halo tagger is the total energy deposited in ECAL by a hypothetical beam halo muon that passes through the photon cluster. 
Lower bounds for \sieie\ and \sipip\ as well as the requirement on the cluster seed time are employed to reject spurious photon objects arising from ``ECAL spikes'', or anomalous electronic signal induced at the ECAL Barrel photodetectors by nuclear or ionizing interactions in the photocathode.

\section{Electrons}
\label{sec:electrons}

\section{Muons}
\label{sec:muons}

\section{Hadrons and jets}
\label{sec:jets}

% \subsection{Hadronic taus}

\section{Missing Transverse Energy}
\label{sec:met}

\section{ECAL barrel spikes phenomenology}
\label{sec:spikes}

Noise in the photodetector or the detector electronics can result in spurious photon signals. 
Most of the time, such spurious signal is filtered out by multiple layers of protection, starting from the so-called ``spike killer'' algorithm at the level-1 trigger~\cite{CMS_AN_2010-357}. 
Nevertheless, in rare cases, noise in a single ECAL channel coincides with pileup or other energy deposit in the nearby crystals and appear as a high-energy photon cluster.

The origin of ECAL spikes is believed to be interactions of neutrons and other hadronic particles (collectively called neutral hadrons hereafter) with the photocathode material of the ECAL avalanche photo diodes (APD). 
Nuclear fission at the APD surface then causes a large electron avalanche, which is mistaken as a large photon yield scintillation in the ECAL crystal. 
Evidences supporting this hypothesis is documented in Ref.~\cite{CMS_AN_2010-357}. 
In Figure~\ref{fig:spike_lumi_scaling}, scaling of the rate of spikes with the instantaneous luminosity is confirmed, up to much higher luminosity values than was observed at the time when Ref.~\cite{CMS_AN_2010-357} was written.

\begin{figure}[tbp]
  \begin{center}
    \includegraphics[width=0.45\textwidth]{Reconstruction/Figures/spikes/spike_lumi_scaling.pdf}
    \caption{
      Average number of spike clusters in a luminosity section, identified by $\sieie < 0.001$ and $E > 50\GeV$, in muon-triggered events, versus integrated luminosity of the luminosity section.
    }
    \label{fig:spike_lumi_scaling}
  \end{center}
\end{figure}

A known feature of such spurious photon clusters is that the recorded pulse shape of the seed crystal, \ie, the channel with the noise, is not what is expected from a real electromagnetic shower in ECAL. 
In particular, this translates to a distinctive early rec hit time distribution, since the rec hit time is extracted from a fit to the pulse shape assuming a normal pulse.

In the normal CMS data reconstruction, rec hits that are tagged as spike-like are ignored in clustering. 
Rec hits are tagged as spikes if there is very little energy deposit recorded in the surrounding crystals, or if the reconstructed time is out of an allowed window.
Identical algorithms are employed in the HLT and offline reconstructions.

To study an unbiased spike sample, ECAL DIGI samples stored in the SingleMuon AOD datasets are reconstructed into ECAL clusters with no spike cleaning applied. 
DIGIs associated with the standard and ``uncleaned'' photon objects are stored in AOD, and ones for the uncleaned photons is rich in spike-like hits. 
Figure~\ref{fig:showershape_map} shows how narrow clusters are cleaned away in the normal reconstruction.

\begin{figure}[tbp]
  \begin{center}
    \includegraphics[width=0.45\textwidth]{Reconstruction/Figures/spikes/showershapes_standard.pdf}
    \includegraphics[width=0.45\textwidth]{Reconstruction/Figures/spikes/showershapes_uncleaned.pdf}
    \caption{
      Two-dimensional distributions in \sipip\ and \sieie\ of ECAL clusters in the standard reconstruction (left) and the special reconstruction with no spike cleaning (right).
    }
    \label{fig:showershape_map}
  \end{center}
\end{figure}

Figure~\ref{fig:spike_distributions} shows the spacial and temporal distributions of the rec hits seeding narrow ($\sieie < 0.001$) clusters. 
The spacial distribution appears mostly random, indicating that there is no single source of spike-like rec hits. 
The two highest peaks in the time distribution at $t \sim -15\ns$ and $t \sim 10\ns$ are characteristic of pulse shapes, which rise faster than the pulse from the normal scintillation. 
The second peak is understood to come from the next bunch crossing.

\begin{figure}[tbp]
  \begin{center}
    \includegraphics[width=0.45\textwidth]{Reconstruction/Figures/spikes/spike_map.pdf}
    \includegraphics[width=0.45\textwidth]{Reconstruction/Figures/spikes/spike_time.pdf}
    \caption{
      $\eta$--$\phi$ and time distributions of seed hits of narrow ($\sieie < 0.001$) clusters.
    }
    \label{fig:spike_distributions}
  \end{center}
\end{figure}

The small peak at $t\sim 0$ in the time distribution of Fig.~\ref{fig:spike_distributions} is due to actual ``physical'' clusters that happened to have a very narrow cluster shape. 
By processing the \gj\ MC simulation events through this special reconstruction, we see that about 0.5\% of ECAL clusters from prompt photons have $\sieie < 0.001$ as shown in Figure~\ref{fig:sieie_mc}.

\begin{figure}[tbp]
  \begin{center}
    \includegraphics[width=0.45\textwidth]{Reconstruction/Figures/spikes/sieie_mc.pdf}
    \caption{
      \sieie distribution of uncleaned clusters from \gj\ MC simulation.
    }
    \label{fig:sieie_mc}
  \end{center}
\end{figure}

To understand the time distribution, one can investigate the original DIGI samples from which rec hits are made. 
At each event readout, a single ECAL channel outputs 10 ADC signals corresponding to a sampling of the analog pulse output of multi-gain preamplifier (MGPA) in range $t_{0} - 125\ns < t < t_{0} + 100\ns$, where $t_{0}$ is the time of the triggering bunch crossing. 
These 10 signal points can be described well by the formula

\begin{equation} \label{eqn:pulse_shape}
  f(t) = A \left(1 - \frac{t - \tau}{\alpha\beta}\right)^{\alpha} \exp \left(-\frac{t-\tau}{\beta}\right).
\end{equation}

In the formula, parameters $A$ and $\tau$ correspond to the pulse amplitude and peak time, whereas $\alpha$ and $\beta$ control the shape of the pulse. 
Figure~\ref{fig:pulse_examples} illustrates various observed pulse shapes fit with the above formula with all parameters floating. 
A $\chi^{2}$ fit is employed using the average noise amplitude of each MGPA channel as the errors on the data points. 
The noise is measured in ECAL calibration cycles in the inter-fill period and is recorded in the conditions database.

\begin{figure}[tbp]
  \begin{center}
    \includegraphics[width=0.3\textwidth]{Reconstruction/Figures/spikes/pulse_example_normal.pdf}
    \includegraphics[width=0.3\textwidth]{Reconstruction/Figures/spikes/pulse_example_spike.pdf}
    \caption{
      Example ECAL DIGIs and corresponding pulse shapes reconstructed through $\chi^{2}$ fits of Equation~\ref{eqn:pulse_shape}, for normal (left) and spike-like (right) hits.
    }
    \label{fig:pulse_examples}
  \end{center}
\end{figure}

In the $\alpha$--$\beta$ parameter space, seed rec hits of wide clusters concentrate around $(\alpha, \beta) \sim (1.1, 1.7)$, while spike-like hits populate the region $\alpha < 0.9$ as shown in Figure~\ref{fig:spike_alphabeta}.
In fact, the pulse amplitude distribution of narrow-cluster seeds with $\alpha > 0.9$ is unlike that of the narrow-cluster seeds with $\alpha < 0.9$, and resembles the amplitude distribution of wide-cluster seeds shown in Figure~\ref{fig:spike_amplitudes}.
This suggests that the population $\alpha > 0.9$ correspond to the clusters of physical, prompt photons.
It then follows that spike hits can be regarded to exclusively have sharp pulse shapes.

\begin{figure}[tbp]
  \begin{center}
    \includegraphics[width=0.45\textwidth]{Reconstruction/Figures/spikes/alphabeta_physical.pdf}
    \includegraphics[width=0.45\textwidth]{Reconstruction/Figures/spikes/alphabeta_spike.pdf}
    \caption{
      $\alpha$--$\beta$ distributions of the seed hits of physical wide clusters (left) and spike-like clusters (right).
    }
    \label{fig:spike_alphabeta}
  \end{center}
\end{figure}

\begin{figure}[tbp]
  \begin{center}
    \includegraphics[width=0.3\textwidth]{Reconstruction/Figures/spikes/physical_amplitude.pdf}
    \includegraphics[width=0.3\textwidth]{Reconstruction/Figures/spikes/spike_amplitude.pdf}
    \includegraphics[width=0.3\textwidth]{Reconstruction/Figures/spikes/narrow_largealpha_amplitude.pdf}
    \caption{
      Seed crystal pulse amplitude distributions of physical wide clusters (left), narrow clusters with $\alpha < 0.9$ (center), and narrow clusters with $\alpha > 0.9$ (right).
    }
    \label{fig:spike_amplitudes}
  \end{center}
\end{figure}

\iffalse
\section{Non-collision signatures}

Things that don't come from protons.

\subsection{Beam halo}

\subsection{ECAL Spikes}

\subsection{Fake MET}
\fi
